<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Set Operations on Time Intervals • phinterval</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Set Operations on Time Intervals">
<meta name="description" content="Implements the phinterval vector class for representing time spans that may contain gaps (disjoint intervals) or be empty. This class generalizes the lubridate package's interval class to support vectorized set operations (intersection, union, difference, complement) that always return a valid time span, even when disjoint or empty intervals are created.">
<meta property="og:description" content="Implements the phinterval vector class for representing time spans that may contain gaps (disjoint intervals) or be empty. This class generalizes the lubridate package's interval class to support vectorized set operations (intersection, union, difference, complement) that always return a valid time span, even when disjoint or empty intervals are created.">
<meta property="og:image" content="https://ethansansom.github.io/phinterval/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">phinterval</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/phinterval.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EthanSansom/phinterval/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="phinterval-">phinterval <a class="anchor" aria-label="anchor" href="#phinterval-"></a>
</h1>
</div>
<!-- badges: start -->

<p>phinterval is a package for representing and manipulating time spans that may contain gaps. It implements the <code>&lt;phinterval&gt;</code> (think “potentially-holey-interval”) vector class, designed as an extension of the <a href="https://lubridate.tidyverse.org/" class="external-link">{lubridate}</a> <code>&lt;Interval&gt;</code>, to represent spans of time that are contiguous, disjoint, empty, or missing.</p>
<p>Functionality for manipulating these spans includes:</p>
<ul>
<li>Merging overlapping or adjacent intervals into non-overlapping sets of time spans.</li>
<li>Performing set operations: union, intersection, difference, and complement.</li>
<li>Testing whether time spans, dates, or times fall within one another or overlap.</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the released version from <a href="https://cran.r-project.org/" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"phinterval"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of phinterval from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"EthanSansom/phinterval"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Each element of a <code>&lt;phinterval&gt;</code> vector is a set of non-overlapping and non-adjacent intervals. For scalar intervals (one span per element), <code><a href="reference/phinterval.html">phinterval()</a></code> works like <code><a href="https://lubridate.tidyverse.org/reference/interval.html" class="external-link">lubridate::interval()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EthanSansom/phinterval" class="external-link">phinterval</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create scalar phintervals (equivalent to interval())</span></span>
<span><span class="fu"><a href="reference/phinterval.html">phinterval</a></span><span class="op">(</span></span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2000-01-01"</span>, <span class="st">"2000-01-03"</span>, <span class="st">"2000-01-04"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  end <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2000-01-02"</span>, <span class="st">"2000-01-05"</span>, <span class="st">"2000-01-09"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;phinterval&lt;UTC&gt;[3]&gt;</span></span>
<span><span class="co">#&gt; [1] {2000-01-01--2000-01-02} {2000-01-03--2000-01-05} {2000-01-04--2000-01-09}</span></span></code></pre></div>
<p>To create phintervals with multiple disjoint spans per element, use the <code>by</code> argument to group intervals. Overlapping or adjacent spans within each group are automatically merged:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a phinterval with disjoint spans using the by argument</span></span>
<span><span class="va">phint</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/phinterval.html">phinterval</a></span><span class="op">(</span></span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2000-01-03"</span>, <span class="st">"2000-01-01"</span>, <span class="st">"2000-01-04"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  end <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2000-01-05"</span>, <span class="st">"2000-01-02"</span>, <span class="st">"2000-01-09"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">phint</span></span>
<span><span class="co">#&gt; &lt;phinterval&lt;UTC&gt;[2]&gt;</span></span>
<span><span class="co">#&gt; [1] {2000-01-03--2000-01-05}                        </span></span>
<span><span class="co">#&gt; [2] {2000-01-01--2000-01-02, 2000-01-04--2000-01-09}</span></span></code></pre></div>
<p>Graphically, the elements of <code>phint</code> are represented as:</p>
<p><img src="reference/figures/README-/phinterval.svg" width="100%"></p>
<p>In most cases, a <code>&lt;phinterval&gt;</code> vector will appear as the result of manipulating <code>&lt;Interval&gt;</code> vectors. For example, <code><a href="reference/squash.html">phint_squash()</a></code> flattens a vector of time spans into a scalar <code>&lt;phinterval&gt;</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jan_1_to_9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/interval.html" class="external-link">interval</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2000-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2000-01-09"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">jan_1_to_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/interval.html" class="external-link">interval</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2000-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2000-01-02"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">jan_3_to_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/interval.html" class="external-link">interval</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2000-01-03"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2000-01-05"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">jan_4_to_9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/interval.html" class="external-link">interval</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2000-01-04"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2000-01-09"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">jan_1_to_2</span>, <span class="va">jan_3_to_5</span>, <span class="va">jan_4_to_9</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/squash.html">phint_squash</a></span><span class="op">(</span><span class="va">ints</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;phinterval&lt;UTC&gt;[1]&gt;</span></span>
<span><span class="co">#&gt; [1] {2000-01-01--2000-01-02, 2000-01-03--2000-01-09}</span></span></code></pre></div>
<p>The squashed intervals contain the set of time spans within <em>any</em> of the input intervals, without duplication.</p>
<p><img src="reference/figures/README-/phint_squash.svg" width="100%"></p>
</div>
<div class="section level2">
<h2 id="example-employment-history">Example: Employment History<a class="anchor" aria-label="anchor" href="#example-employment-history"></a>
</h2>
<p>The phinterval package is most useful when working with tabular data, such as a longitudinal employment panel.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">jobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">name</span>,   <span class="op">~</span><span class="va">job_title</span>,             <span class="op">~</span><span class="va">start</span>,        <span class="op">~</span><span class="va">end</span>,</span>
<span>  <span class="st">"Greg"</span>,  <span class="st">"Mascot"</span>,               <span class="st">"2018-01-01"</span>,  <span class="st">"2018-06-03"</span>,</span>
<span>  <span class="st">"Greg"</span>,  <span class="st">"Executive Assistant"</span>,  <span class="st">"2018-06-10"</span>,  <span class="st">"2020-04-01"</span>,</span>
<span>  <span class="st">"Shiv"</span>,  <span class="st">"Political Consultant"</span>, <span class="st">"2017-01-01"</span>,  <span class="st">"2019-04-01"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">employment</span> <span class="op">&lt;-</span> <span class="va">jobs</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Squash overlapping/adjacent intervals into a single phinterval</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>employed <span class="op">=</span> <span class="fu"><a href="reference/squash.html">datetime_squash</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="va">start</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="va">end</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Invert the employment timeline to find gaps</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>unemployed <span class="op">=</span> <span class="fu"><a href="reference/phint_invert.html">phint_invert</a></span><span class="op">(</span><span class="va">employed</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">employment</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span><span class="co">#&gt;   name  employed                    unemployed              </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;phint&lt;UTC&gt;&gt;                &lt;phint&lt;UTC&gt;&gt;            </span></span>
<span><span class="co">#&gt; 1 Greg  {2018-01-01-[2]-2020-04-01} {2018-06-03--2018-06-10}</span></span>
<span><span class="co">#&gt; 2 Shiv  {2017-01-01--2019-04-01}    &lt;hole&gt;</span></span></code></pre></div>
<p><code>&lt;phinterval&gt;</code> column formatting adapts to the available console width. The <code>"[2]"</code> in Greg’s employment interval <code>"{2018-01-01-[2]-2020-04-01}"</code> indicates that his employment history is made up of two disjoint spans, with the first span beginning on 2018-01-01 and the second ending on 2020-04-01. When more space is available, every span is shown explicitly.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">employment</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">employed</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span><span class="co">#&gt;   name  employed                                        </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;phint&lt;UTC&gt;&gt;                                    </span></span>
<span><span class="co">#&gt; 1 Greg  {2018-01-01--2018-06-03, 2018-06-10--2020-04-01}</span></span>
<span><span class="co">#&gt; 2 Shiv  {2017-01-01--2019-04-01}</span></span></code></pre></div>
<p>Operations on <code>&lt;phinterval&gt;</code> vectors behave like those on standard intervals. Here, we can see that there was a 7-day gap in Greg’s employment history:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">employment</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    days_employed <span class="op">=</span> <span class="va">employed</span> <span class="op">/</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/duration.html" class="external-link">ddays</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    days_unemployed <span class="op">=</span> <span class="va">unemployed</span> <span class="op">/</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/duration.html" class="external-link">ddays</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">days_employed</span>, <span class="va">days_unemployed</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span><span class="co">#&gt;   name  days_employed days_unemployed</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Greg            814               7</span></span>
<span><span class="co">#&gt; 2 Shiv            820               0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="phinterval---lubridate">phinterval &lt;-&gt; lubridate<a class="anchor" aria-label="anchor" href="#phinterval---lubridate"></a>
</h2>
<p>The <code>&lt;phinterval&gt;</code> class is a generalization of the <code>&lt;Interval&gt;</code> class, meaning any <code>&lt;Interval&gt;</code> can be converted into an equivalent <code>&lt;phinterval&gt;</code> and all phinterval functions accept either <code>&lt;Interval&gt;</code> or <code>&lt;phinterval&gt;</code> inputs. The table below shows the lubridate functions that have drop-in phinterval replacements.</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>phinterval</th>
<th>lubridate</th>
<th>Returns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>phinterval(start, end)</code></td>
<td><code>interval(start, end)</code></td>
<td>Spans bounded by <code>start</code>/<code>end</code>
</td>
</tr>
<tr class="even">
<td><code>phint_intersect(x, y)</code></td>
<td><code>intersect(x, y)</code></td>
<td>Times in <code>x</code> and <code>y</code>
</td>
</tr>
<tr class="odd">
<td><code>phint_setdiff(x, y)</code></td>
<td><code>setdiff(x, y)</code></td>
<td>Times in <code>x</code>, but not in <code>y</code>
</td>
</tr>
<tr class="even">
<td><code>phint_union(x, y)</code></td>
<td><code>union(x, y)</code></td>
<td>Times in <code>x</code> or <code>y</code>
</td>
</tr>
<tr class="odd">
<td><code>phint_start(x)</code></td>
<td><code>int_start(x)</code></td>
<td>The start time of <code>x</code>
</td>
</tr>
<tr class="even">
<td><code>phint_end(x)</code></td>
<td><code>int_end(x)</code></td>
<td>The end time of <code>x</code>
</td>
</tr>
<tr class="odd">
<td><code>phint_length(x)</code></td>
<td><code>int_length(x)</code></td>
<td>The number of seconds in <code>x</code>
</td>
</tr>
<tr class="even">
<td><code>phint_overlaps(x, y)</code></td>
<td><code>int_overlaps(x, y)</code></td>
<td>Whether <code>x</code> and <code>y</code> intersect</td>
</tr>
<tr class="odd">
<td><code>phint_within(x, y)</code></td>
<td><code>x %within% y</code></td>
<td>Whether <code>y</code> contains <code>x</code>
</td>
</tr>
<tr class="even">
<td><code>x / duration(...)</code></td>
<td><code>x / duration(...)</code></td>
<td>How many durations fit in <code>x</code>
</td>
</tr>
</tbody>
</table>
<p>All phinterval set operations work as expected with arbitrary time spans, enabling operations that are not supported by lubridate. For example, the intersection of two non-overlapping intervals is an empty time span, called a <code>&lt;hole&gt;</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">jan_1_to_2</span>, <span class="va">jan_4_to_9</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA--NA</span></span>
<span><span class="fu"><a href="reference/phinterval-set-operations.html">phint_intersect</a></span><span class="op">(</span><span class="va">jan_1_to_2</span>, <span class="va">jan_4_to_9</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;phinterval&lt;UTC&gt;[1]&gt;</span></span>
<span><span class="co">#&gt; [1] &lt;hole&gt;</span></span></code></pre></div>
<p>The set-difference of a time span and itself is also a <code>&lt;hole&gt;</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">jan_1_to_2</span>, <span class="va">jan_1_to_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2000-01-01 UTC--2000-01-02 UTC</span></span>
<span><span class="fu"><a href="reference/phinterval-set-operations.html">phint_setdiff</a></span><span class="op">(</span><span class="va">jan_1_to_2</span>, <span class="va">jan_1_to_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;phinterval&lt;UTC&gt;[1]&gt;</span></span>
<span><span class="co">#&gt; [1] &lt;hole&gt;</span></span></code></pre></div>
<p>Performing a set-difference may “punch a hole” in a time span, creating a discontinuous interval.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">jan_1_to_9</span>, <span class="va">jan_3_to_5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in setdiff.Interval(jan_1_to_9, jan_3_to_5) : </span></span>
<span><span class="co">#&gt;   Cases 1 result in discontinuous intervals.</span></span>
<span><span class="fu"><a href="reference/phinterval-set-operations.html">phint_setdiff</a></span><span class="op">(</span><span class="va">jan_1_to_9</span>, <span class="va">jan_3_to_5</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;phinterval&lt;UTC&gt;[1]&gt;</span></span>
<span><span class="co">#&gt; [1] {2000-01-01--2000-01-03, 2000-01-05--2000-01-09}</span></span></code></pre></div>
<p>The union of two disjoint intervals is a single <code>&lt;phinterval&gt;</code> containing two spans.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">union</a></span><span class="op">(</span><span class="va">jan_1_to_2</span>, <span class="va">jan_4_to_9</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2000-01-01 UTC--2000-01-09 UTC</span></span>
<span><span class="fu"><a href="reference/phinterval-set-operations.html">phint_union</a></span><span class="op">(</span><span class="va">jan_1_to_2</span>, <span class="va">jan_4_to_9</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;phinterval&lt;UTC&gt;[1]&gt;</span></span>
<span><span class="co">#&gt; [1] {2000-01-01--2000-01-02, 2000-01-04--2000-01-09}</span></span></code></pre></div>
<p>As with the lubridate equivalents, all phinterval set operations are vectorized.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/phinterval-set-operations.html">phint_intersect</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">jan_1_to_2</span>, <span class="va">jan_3_to_5</span>, <span class="va">jan_1_to_2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">jan_1_to_9</span>, <span class="va">jan_4_to_9</span>, <span class="va">jan_4_to_9</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;phinterval&lt;UTC&gt;[3]&gt;</span></span>
<span><span class="co">#&gt; [1] {2000-01-01--2000-01-02} {2000-01-04--2000-01-05} &lt;hole&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="inspiration">Inspiration<a class="anchor" aria-label="anchor" href="#inspiration"></a>
</h2>
<p>This package builds on <a href="https://lubridate.tidyverse.org/" class="external-link">{lubridate}</a>’s <code>&lt;Interval&gt;</code> class for representing contiguous time spans. The prototype <code>&lt;phinterval&gt;</code> data structure (a list of matrices) and the C++ implementation of <code><a href="reference/squash.html">phint_squash()</a></code> were inspired by the <a href="https://CRAN.R-project.org/package=intervals" class="external-link">{intervals}</a> package by Richard Bourgon and Edzer Pebesma. The figures used in this README were inspired by Davis Vaughan’s <a href="https://davisvaughan.github.io/ivs/" class="external-link">{ivs}</a> package documentation.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=phinterval" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/EthanSansom/phinterval/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/EthanSansom/phinterval/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing phinterval</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ethan Sansom <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0009-0000-1573-0186" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://app.codecov.io/gh/EthanSansom/phinterval" class="external-link"><img src="https://codecov.io/gh/EthanSansom/phinterval/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/EthanSansom/phinterval/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/EthanSansom/phinterval/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ethan Sansom.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
